<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Ii18n and L10n</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="../../styles/slides.css">
  <link rel="stylesheet" href="charset/table.css">
  <script src="../../js/ix.js"></script>
  <script data-main="../../js/slides.js" src="../../third-js/requirejs/require.js"></script>
</head>
<body>
<div class="reveal">
  <div class="slides">
    <section class="cover">
      <h1>information in a global world</h1>
      <h2>info-20002: foundations of informatics</h2>
    </section>

    <section>
      <h2>Diversity of languages of website content</h2>
      <div style="display:none">
      <table id="lang-stat-content-data">
        <tr><td>1</td><td>English</td><td>55.5%</td></tr>
        <tr><td>2</td><td>Russian</td><td>6.0%</td></tr>
        <tr><td>3</td><td>German</td><td>5.8%</td></tr>
        <tr><td>4</td><td>Japanese</td><td>5.0%</td></tr>
        <tr><td>5</td><td>Spanish</td><td>4.6%</td></tr>
        <tr><td>6</td><td>French</td><td>4.0%</td></tr>
        <tr><td>7</td><td>Chinese</td><td>2.8%</td></tr>
        <tr><td>8</td><td>Portuguese</td><td>2.5%</td></tr>
        <tr><td>9</td><td>Italian</td><td>1.9%</td></tr>
        <tr><td>10</td><td>Polish</td><td>1.7%</td></tr>
        <tr><td>11</td><td>Others</td><td>10.2%</td></tr>
      </table>
      </div>
      <div style="width:100%">
        <div id="lang-stat-content-chart" class="figure" style="margin:auto"></div>
      </div>
      <script>
        ix.register(function () {
          categories = _.reduce($('#lang-stat-content-data tr td:nth-child(2)'),
            function (m, td) { return m.concat([$(td).text()]); }, []);
          data = _.reduce($('#lang-stat-content-data tr td:nth-child(3)'),
            function (m, td) { return m.concat([parseFloat($(td).text())]); }, []);
          ix.doChart.column('#lang-stat-content-chart', categories, data, 'Country', 'Percentage');
        });
      </script>
      <div class="footer">
        <div>W3Techs.com.
          <a href="http://w3techs.com/technologies/overview/content_language/all">
            Usage of content languages for websites.</a> Retrieved Mar 2015.
        </div>
      </div>
    </section>

    <section>
      <h2>Diversity of languages of website users</h2>
      <div style="width:100%">
        <div id="lang-stat-user-chart" class="figure" style="margin:auto"></div>
      </div>

      <script>
        ix.register(function () {
          var categories = [
            'English', 'Chinese', 'Spanish', 'Japanese', 'Portuguese', 'German',
            'Arabic', 'French', 'Russian', 'Korean', 'Others'
          ];
          var data = [
            27, 25, 8, 5, 4, 4, 3, 3, 3, 2, 17
          ];
          ix.doChart.column('#lang-stat-user-chart', categories, data, 'Country', 'Percentage');
        });
      </script>
      <div class="footer">
        <div>Internet World Stats.
          <a href="http://www.internetworldstats.com/stats7.htm">Number of Internet Users by Language as of 31 May 2011.</a>
        </div>
      </div>
    </section>

    <section>
      <img src="images/sign5langs.png" style="width:100%">
    </section>

    <section data-background="images/un.png">
      <p>
        <a href="http://www.un.org">http://www.un.org</a>
      </p>
    </section>

    <section data-background="images/rio2016.png" data-background-size="1200px">
      <p>
        2016 rio olympics<br /><a href="http://www.rio2016.com/en">http://www.rio2016.com/en</a>
      </p>
    </section>

    <section>
      <h1>i18n &amp; L10n</h1>
      <h3>localization</h3>
      <p>modifying or adapting an application to fit the requirements of a particular locale</p>
      <p>a <em>locale</em> is a collection of parameters that the defines a specific language, country, script, rules, and coded character set</p>
      <h3>internationalization</h3>
      <p>designing an application so that it can operate in multiple locales without any engineering change to the application.</p>
      <div class="footer">
        <div>
          <a href="http://www-01.ibm.com/software/globalization/index.html">
            IBM Software - Globalize your business
          </a>
        </div>
        <div>
          <a href="https://msdn.microsoft.com/en-us/goglobal/bb688110.aspx">
            Microsoft - Globalization step by step
          </a>
        </div>
      </div>
    </section>

      <style>
      #i18n-issues table td:first-child {
        color: #887766;
      }
      </style>

    <section data-markdown id="i18n-issues">
      <script type="text/template">
issues in i18n &amp; L10n
=====================

| &nbsp; | &nbsp; |
| ---------:|---|
|characters set &amp; encoding | Welcome or Καλώς Ήρθατε |
|language translations | Hello or Bonjour |
|currency format | $ £ € ¥ |
|numerical format | 1,457 or 1.457 |
|date/time format | 08/09/2008 (*8 September* or *9 August*?) |
      </script>
    </section>

    <section data-markdown>
      <script type="text/template">
character sets
=====================

A character is a indivisible unit of text. A character set defines the range of a character collection. Examples:

| charset | num. of chars | encoding
| ---------:|---:|---|
|ASCII (Basic Latin)|	128	|7-bit ASCII|
|ISO-8859-1<br />(Latin-1 Western European)|	191|	8-bit ISO-8859-1|
|Windows-1252	|251|	8-bit Windows-1252|
|GB2312 (Simplified Chinese)	| 6,763	| EUC-CN, HZ|
|Unicode	| 1,114,112	|UTF-8, UTF-16, UTF-32|
      </script>
    </section>

    <section>
      <div id="charset-table-ascii"></div>
      <script src="charset/charset.js"></script>
      <script src="charset/table.js"></script>
  <script>
      ix.register(function () {
        var id = '#charset-table-ascii';
        ix.tables.charset.init(id);
        ix.tables.charset.update(id, charset_ascii);
      });
  </script>
    </section>

    <section data-markdown>
      <script type="text/template">
ASCII
=====================

<span style="font-size:16px; font-weight:bold">``!"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~``</span>

- American Standard Code for Information Interchange
- Supports Basic Latin characters
- Limited support for European languages
- **é** in *café* is not supported

How can we support other languages:

- Extended Latin charsets (Windows-1252 or ISO-8859-1 (Latin-1))
- Various charsets:
  - Shift-JIS: Japanese
  - Windows-1251: Cyrillic (Russian, Bulgarian, etc.)
  - Big5, GB2312: Chinese
- Problems: overlaps across encodings/representation of these proprietary character sets.
    </script>
    </section>

    <section>
      <div class="footer"><a href="charset/table.html">Comparison of ASCII, Windows 1252, and ISO-8859-1</a> (click to cycle)<br />&nbsp;</div>
      <iframe style="width:900px;height:600px;" src="charset/table.html"></iframe>
    </section>

    <section data-markdown>
      <script type="text/template">
Unicode
=====================

- Provide a universal character set that encapsulates almost all characters in the world's languages
- A collection of abstract characters, each identified by an integer/number called **code point** and **unique name** (coded character set)
- In Unicode, code point is NOT the way computer represents (encodes) the character, but it is used to identify the character

<p style="font-size:1em;font-weight:bold"><span style="color:green;font-size:2em">`é`</span>&nbsp; `U+00E9` `'LATIN SMALL LETTER E WITH ACUTE'`</p>

- `00E9` is the code point of the character
- `LATIN SMALL LETTER E WITH ACUTE` is the name of the character
    </script>
    </section>


    <section data-markdown>
      <script type="text/template">
character encoding
=========================

- A character is NOT the physical (binary) representation in a file, in a web page or in a device. A character is an abstract entity, its actual representation is determined by **character encoding**; encoding maps a logical character to a numerical value
- The terms character set and encoding are often used interchangeably (while it is not a problem for ASCII &amp; Windows 1252, it is problematic for Unicode)
    </script>
    </section>

    <section data-markdown>
      <script type="text/template">
character encoding
=========================

- Encoding is a mapping from a logical representation of a character to its physical representation
- Encoding maps a character to (one or more) bytes
    </script>
    </section>

    <section>
      <h2>various encodings of <strong>é</strong></h2>
      <div id="tree-container" style="width:800px;height:600px;margin-left:0px"></div>
      <style>
        g.node {
          font-size: 1em;
          font-weight: bold;
        }

        .edgelabel {
          font-weight: bold;
        }

        circle.node-dot {
          fill: #cccccc;
          stroke: #aaaaaa;
          stroke-width: 4px;
        }

        path.link {
          fill: none;
          stroke: gray;
        }
      </style>
      <script src="js/encoding.js"></script>
      <script>
      ix.register(function () {
        var treeData = {
          name: "é",
          children: [
            {name: "e9"},
            {name: "e9"},
            {name: "c3e9"},
            {name: "00e9"},
            {name: "82"}
          ],
          labels: [
            'latin-1 / iso-8859-1',
            'cp1252',
            'utf-8',
            'utf-16',
            'cp437'
          ]
        };
        ix.figures.encoding("#tree-container", treeData);
      });
      </script>
    </section>

    <section data-markdown>
      <script type="text/template">
encoding of input and output
=========================

- Encoding is needed for interpreting a piece of data: text file, XML file, web page (which are blobs of bytes)
- Programmers need to know the encoding of data that goes into or comes from a device (keyboard, screen, or web browser)

Example: it's best to specify the encoding used in your HTML page.

    <DOCTYPE html>
    <html>
    <head>
      <meta http-equiv="content-type"
            content="text/html; charset=UTF-8" />
    </head>
    <body>
    ...

    </script>
    </section>

    <section data-background="white">
<h2>chrome browser encoding</h2>
<img src="images/chrome-encoding.png" style="height:800px;">
    </section>

    <section data-background="images/baidu-utf-8.png">
<!--<h2>baidu.com - utf-8</h2>
<img src="images/baidu-utf-8.png" style="height:800px;">-->
    </section>

    <section data-background="images/baidu-windows-1252.png">
<!--<h2>baidu.com - windows-1252</h2>
<img src="images/baidu-windows-1252.png" style="height:800px;">-->
    </section>

    <section>
      <h2>Unicode encoding</h2>
<ul>
<li>ASCII characters are encoded as 1 byte (a single way of encoding)</li>
<li>Unicode uses variable length encoding: 1-4 bytes (multiple ways of encoding: UTF-8, UT-16, UTF-32)</li>
</ul>

<div id="fig-unicode-encoding" style="width:800px;height:300px;margin-left:0px"></div>

<div class="footer">
  <ul>
  <li>
      <strong>é</strong> (code point U+00E9) belongs to <a href="http://www.unicode.org/charts/PDF/U0080.pdf">Latin-1 Supplement group in Unicode</a>.
  </li>
  <li>
    <a href="http://macchiato.com/unicode/convert.html">Unicode encoder</a>
  </li>
  <li>
    <a href="http://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&item_id=IWS-AppendixA">Mapping codepoints to Unicode encoding</a>
  </li>
</ul>
</div>


      <script>
      ix.register(function () {
        var data = {
          name: "é",
          children: [
            {name: "c3e9"},
            {name: "00e9"}
          ],
          labels: [
            'utf-8',
            'utf-16'
          ]
        };
        ix.figures.encoding("#fig-unicode-encoding", data);
      });
      </script>
    </section>


    <section>
      <h2>UTF-8 encoding</h2>
<ul>
<li>The most commonly used encoding is UTF-8</li>
<li>Backward compatible with ASCII; all ASCII data are also UTF-8 encoded</li>
</ul>

<div id="fig-utf-8-encoding" style="width:800px;height:500px;margin-left:0px"></div>


      <script>
      ix.register(function () {
        var data = {
          name: "a",
          children: [
            {name: "61"},
            {name: "61"},
            {name: "0061"},
            {name: "00000061"}
          ],
          labels: [
            'ascii',
            'utf-8',
            'utf-16',
            'utf-32'          ]
        };
        ix.figures.encoding("#fig-utf-8-encoding", data);
      });
      </script>
    </section>

    <section data-background="images/sign4langs.png" style="color:white;">
    </section>

    <section data-markdown>
      <script type="text/template">
Python and Unicode
=====================

- Python supports (1) **byte string** and (2) **Unicode string**
- Unicode string starts with `u` prefix

```
>>> e_acute = u'\u00e9' # Unicode string
>>> e_acute.encode('utf-8')
'\xc3\xa9' # byte string
```

- Unicode string is an abstract or logical representation of characters.
- Python byte string is a physical representation.
- Sending to a file, web page, device, you need to encode.
    </script>
    </section>


    <section data-markdown>
      <script type="text/template">
encoding in Python
=====================

To convert Unicode string to byte string use `encode(encoding)` function:

    >>> e_acute = u'\u00e9'
    >>> e_acute.encode('utf-8')
    '\xc3\xa9'
    >>> e.encode('latin-1')
    '\xe9'
    >>> e.encode('cp1252')
    '\xe9'

    </script>
    </section>

    <section data-markdown>
      <script type="text/template">
decoding in Python
=====================

To convert byte string to Unicode string use `decode(encoding)` function:

    >>> something = '\xc3\xa9'
    >>> print something.decode('utf-8')
    é
    >>> print something.decode('cp1252')
    Ã©
    </script>
    </section>

    <section>
      <h2>decode: interpreting bytes</h2>

<div id="fig-decoding" style="width:800px;height:500px;margin-left:0px"></div>

      <script>
      ix.register(function () {
        var data = {
          name: "c3a9",
          children: [
            {name: "é"},
            {name: "Ã©"},
          ],
          labels: [
            'utf-8',
            'cp-1252'         ]
        };
        ix.figures.encoding("#fig-decoding", data);
      });
      </script>
    </section>

    <section data-markdown>
      <script type="text/template">
consuming unicode
=====================

```
demo.1.xml

<?xml version="1.0" encoding="UTF-8"?>
<demo>
  <sentence lang="chinese">我爱你</sentence>
  <sentence lang="kazakh">фыыудa</sentence>
  <sentence lang="iceland">Björk</sentence>
</demo>
```
      </script>
    </section>

    <section data-markdown>
      <script type="text/template">
consuming utf-8 xml
=====================

`lxml`'s `etree` provides Unicode string where necessary

    from lxml import etre
    etree = etree.parse( "demo-1.xml" )
    root = tree.getroot()
    for sentence in root:
      print type(sentence.text) # the type of is <unicode>
      </script>
    </section>

    <section data-markdown>
      <script type="text/template">
producing web page in utf-8
=====================

    str = '''<html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=UTF-8">
      <title>Unicode demo</title>
    </head>
    <body>
    '''
    # specify the web page is in UTF-8,
    # so that the browser can interpret correctly
    ...

    </script>
    </section>

    <section data-markdown>
      <script type="text/template">
producing data in utf-8 (output)
----------------------

    **UnicodeEncodeError: 'ascii' codec can't encode characters in
    position 0-2: ordinal not in range(128)**

      </script>
    </section>


    <section data-markdown>
      <script type="text/template">
issue
========

- Everytime you send a Unicode string to a device, a network, or a disk (e.g. using `print` or `file.write()`), the *Unicode string* needs to be encoded to as *byte string*. If programmer do not do that explicitly, Python does this for you automatically.
- If no encoding is specified, it uses the default encoding (sometimes `ascii`).
```
>>> import sys
>>> sys.getdefaultencoding()
'ascii'
```
- Not all Unicode characters can be encoded in target encoding (e.g. ASCII (0-127))

**Solution**: Explicitly encode using supported encoding (e.g UTF-8).

    ...
    print a_unicode_string.encode('utf-8')
    ...

      </script>
    </section>

    <section data-markdown>
      <script type="text/template">
supporting internationalization in Python
========================================

- Logically store all characters in Unicode
- Perform all string processing in Unicode string
- **Decode early**: Data from file or from user input should be stored/processed as Unicode string (decode your python byte string to Unicode string).
- **Encode last**: If you have to serialize a Unicode string to a device (to a web page using print or to a file using `write()`, encode your Unicode strings using appropriate encoding supported by the device (e.g. "utf-8" ).
- In receiving/displaying characters from user input/output, you need to know the supported encoding of the I/O device (keyboard, screen, or web browser).
      </script>
    </section>

    <section data-markdown>
      <script type="text/template">
locale
=====================

- support software ability to deal with certain cultural issues in various locales (countries) without requiring the programmer to know all the detail about those locales
- the issues: formatting of numerical value, monetary value, and date
- use Python's `locale` module

      >>> import locale
      >>> import time
      >>> locale.setlocale(locale.LC_ALL, 'English_Australia')
      'English_Australia.1252'
      >>> time.strftime('%X %x %A') # time, date, day of week
      '5:40:19 PM 16/09/2008 Tuesday'
      >>> locale.setlocale(locale.LC_ALL, 'English_US')
      'English_United States.1252'
      >>> time.strftime('%X %x %A')
      '5:40:35 PM 9/16/2008 Tuesday'
    </script>
    </section>

    <section data-background="white">
<h1>managing translation</h1>
      <style>
      .multi-box {
        width: 800px;
        height: 170px;
        padding: 5px;
        border: #cccccc 1px solid !important;
        margin-bottom: 5px !important;
      }
      </style>
<div class="multi-box">
<img src="images/multi-english.png" style="width:520px">
</div>
<div class="multi-box">
<img src="images/multi-italian.png" style="width:570px">
</div>
<div class="multi-box">
<img src="images/multi-singhalese.png" style="width:450px">
</div>
    </section>


    <section data-markdown>
      <script type="text/template">
lost in translations
=====================

    ...
    fs = cgi.FieldStorage()
    lang = fs.get_first("lang")
    if lang == "English":
      print "Hello"
    elif lang == "French":
      print "Bonjour"
    elif lang == "Italian":
      print "Alo"
    ...

    </script>
    </section>

    <section>
<h1>separation of concerns</h1>

<img src="images/multi-ling.png" style="width:800px">
    </section>

  </div>
</div>
</body>
</html>